{% extends "PatientApp/base.html" %}

{% block content %}
<style>
    /* Dashboard-specific container */
    .dashboard-container {
        width: 100%;
        max-width: 900px;
        background: white;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }

    /* Date and Time Header */
    .datetime-header {
        display: flex;
        justify-content: space-between;
        font-size: 24px;
        font-weight: 800;
        margin-bottom: 30px;
        color: #000;
    }

    /* Current Patient Card (The Big Box) */
    .current-patient-card {
        display: flex;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        min-height: 200px; /* Ensures height even if empty */
    }

    /* Left Side (Blue Header & ID) */
    .patient-id-box {
        width: 40%;
        text-align: center;
        border-right: 1px solid #e0e0e0;
        display: flex;
        flex-direction: column;
    }
    .id-header {
        background-color: #1a4d8c;
        color: white;
        padding: 10px;
        font-weight: 600;
        font-size: 14px;
    }
    .id-number {
        font-size: 48px;
        font-weight: 800;
        color: #000;
        flex-grow: 1;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Right Side (Details) */
    .patient-details-box {
        width: 60%;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: left;
    }
    .patient-name {
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 10px;
        min-height: 27px; /* Maintains layout if empty */
    }
    .patient-info {
        font-size: 14px;
        color: #555;
        line-height: 1.6;
        margin-bottom: 20px;
        min-height: 60px; /* Maintains layout if empty */
    }

    /* Action Buttons in Card */
    .card-actions {
        display: flex;
        gap: 10px;
    }
    .btn-small {
        padding: 8px 15px;
        font-size: 13px;
        border-radius: 4px;
        cursor: pointer;
        font-weight: 600;
        border: none;
        text-decoration: none;
    }
    .btn-details {
        background: white;
        border: 1px solid #ccc;
        color: #333;
    }
    .btn-complete {
        background-color: #3b82f6;
        color: white;
    }

    /* Search Bar */
    .search-container {
        position: relative;
        margin-bottom: 25px;
    }
    .search-input {
        width: 100%;
        padding: 12px 15px 12px 40px;
        border: 1px solid #eee;
        border-radius: 6px;
        font-size: 14px;
        background-color: #fff;
    }
    .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
    }

    /* Queue Table */
    .queue-table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #eee;
    }
    .queue-table th {
        background-color: #1a4d8c;
        color: white;
        text-align: left;
        padding: 12px 20px;
        font-size: 14px;
        font-weight: 600;
    }
    .queue-table td {
        padding: 12px 20px;
        border-bottom: 1px solid #eee;
        color: #333;
        font-size: 14px;
    }
    .empty-message {
        text-align: center;
        padding: 20px;
        color: #777;
        font-style: italic;
    }
</style>

<div class="dashboard-container">
    
    <!-- 1. DATE AND TIME HEADER -->
    <div class="datetime-header">
        <span id="current-date">---</span>
        <span id="current-time">---</span>
    </div>

    <!-- 2. CURRENT ATTENDING PATIENT CARD -->
    <!-- 
         TODO: Backend Connection 
         Wrap this entire card in an { if current_patient } block.
         If no patient is active, you can show a "Waiting for next patient..." message instead.
    -->
    <div class="current-patient-card">
        <div class="patient-id-box">
            <div class="id-header">Current Attending Patient</div>
            
            <!-- TODO: Replace '---' with {{ current_patient.id }} -->
            <div class="id-number">---</div> 
        </div>
        
        <div class="patient-details-box">
            <!-- TODO: Replace 'No Patient Selected' with {{ current_patient.name }} -->
            <div class="patient-name">No Patient Selected</div>
            
            <div class="patient-info">
                <!-- TODO: Replace these lines with:
                     {{ current_patient.birthdate }}
                     {{ current_patient.gender }}
                     {{ current_patient.condition }} 
                -->
                Details will appear here...<br>
                <br>
                
            </div>

            <div class="card-actions">
                <!-- TODO: Add href to patient detail view -->
                <button class="btn-small btn-details">Details</button>
                <!-- TODO: Add form or href to mark patient as completed -->
                <button class="btn-small btn-complete">Complete</button>
            </div>
        </div>
    </div>

    <!-- 3. SEARCH BAR -->
    <div class="search-container">
        <span class="search-icon">üîç</span>
        <!-- TODO: Add name="q" and wrap in form for search functionality -->
        <input type="text" class="search-input" placeholder="Search for anything">
    </div>

    <!-- 4. PATIENT QUEUE TABLE -->
    <table class="queue-table">
        <thead>
            <tr>
                <th style="width: 20%;">ID</th>
                <th style="width: 40%;">Name</th>
                <th style="width: 30%;">Condition</th>
                <th style="width: 10%;"></th>
            </tr>
        </thead>
        <tbody>
            <!-- 
                TODO: Loop through your queue list here.
                Example Structure (Remove the backslashes when implementing):
                { for patient in queue_list }
                <tr>
                    <td>{ patient.patient_id }</td>
                    <td>{ patient.name }</td>
                    <td>{ patient.condition }</td>
                    <td style="text-align: right;">
                        <button class="btn-small btn-details">Details</button>
                    </td>
                </tr>
                { empty }
                <tr>
                    <td colspan="4" class="empty-message">No patients in queue.</td>
                </tr>
                { endfor }
            -->
            
            <!-- Placeholder row so the table isn't invisible right now -->
            <tr>
                <td colspan="4" class="empty-message">
                    <!-- This text appears when no data is connected yet -->
                    (Patient list will load here)
                </td>
            </tr>

        </tbody>
    </table>

</div>

<!-- Script for Live Time -->
<script>
    function updateTime() {
        const now = new Date();
        document.getElementById('current-time').innerText = now.toLocaleTimeString();
        document.getElementById('current-date').innerText = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }
    setInterval(updateTime, 1000); 
    updateTime(); 
</script>

{% endblock content %}
